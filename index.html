<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NORTHWESTERN TRAINING INSTITUTE - List of Graduating Students</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300,400,700&display=swap" rel="stylesheet">
    
    <style>
        /* 2. MODERN BASE STYLES */
        :root {
            --primary-color: #2c698d; /* Professional Blue/Teal */
            --header-color: #1e3a5f;
            --background-light: #f9fbfd;
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 6px 15px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-light);
        }
        .container {
            width: 95%;
            max-width: 1400px;
            margin: 30px auto;
            background-color: #fff;
            padding: 30px;
            box-shadow: var(--shadow-medium);
            border-radius: 12px;
        }
        
        /* 1. LOGO FIX: Ensures the logo sits above the sticky controls */
        .logo-container {
            text-align: center;
            margin-bottom: 10px;
            position: relative; 
            z-index: 11;       /* Higher than sticky controls (z-index 10) */
        }
        .logo {
            max-width: 120px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: var(--header-color);
            margin-bottom: 5px;
            border-bottom: 4px solid var(--primary-color);
            padding-bottom: 10px;
            font-weight: 700;
        }
        h2 {
            text-align: center;
            color: #7f8c8d;
            font-size: 1.3em;
            margin-top: 0;
            margin-bottom: 30px;
            font-weight: 300;
        }
        
        /* 2. STICKY CONTROLS FIX: Added background and proper padding for sticky behavior */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            gap: 15px;

            /* STICKY HEADER STYLES */
            position: sticky;
            top: 0;
            z-index: 10;
            /* FIX: Add background to prevent content bleed-through */
            background-color: var(--background-light); 
            
            /* Overlap container padding for full width stickiness */
            margin-top: -20px; 
            margin-left: -30px; 
            margin-right: -30px; 
            padding-left: 30px;
            padding-right: 30px;
            padding-top: 20px;
            padding-bottom: 15px;
        }

        .controls input, .controls select {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }
        .controls input:focus, .controls select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(44, 105, 141, 0.2);
            outline: none;
        }
        .controls input {
            flex-grow: 1;
        }
        .controls select {
            width: 250px; 
            cursor: pointer;
        }
        
        /* 3. STYLISH TABLE */
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden; 
        }
        th, td {
            border: none;
            padding: 15px 20px;
            text-align: left;
        }
        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 3px solid #1e3a5f;
            cursor: pointer; /* Indicates sortable column */
            user-select: none;
            position: relative;
        }

        /* Sorting Icons */
        .sort-icon {
            margin-left: 5px;
            display: inline-block;
            width: 0;
            height: 0;
            vertical-align: middle;
        }
        .asc .sort-icon {
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 5px solid white; /* Up arrow */
        }
        .desc .sort-icon {
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid white; /* Down arrow */
        }

        /* Table Body Rows */
        tr:nth-child(even) {
            background-color: #f4f6f8;
        }
        tr:hover {
            background-color: #e8f5ff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transform: scale(1.005);
            transition: all 0.15s ease-in-out;
        }
        td:nth-child(1) {
            text-align: center;
            width: 50px;
            font-weight: 700;
            color: #555;
        }
        
        /* 4. SEARCH HIGHLIGHTING */
        .highlight {
            background-color: #fffd82; /* Bright yellow/light gold */
            font-weight: bold;
            padding: 2px 0;
            border-radius: 2px;
        }

        /* 5. COURSE LEVEL COLOR CLASSES (Dynamic Highlighting) */
        .level-phd {
            color: #C0392B; 
            font-weight: 700;
            background-color: #fcecec;
            border-radius: 4px;
            padding: 5px 10px;
            display: inline-block;
        }
        .level-masters {
            color: #F39C12; 
            font-weight: 700;
            background-color: #fdf5e6;
            border-radius: 4px;
            padding: 5px 10px;
            display: inline-block;
        }
        .level-diploma {
            color: #3498db; 
            font-weight: 700;
            background-color: #eaf3fb;
            border-radius: 4px;
            padding: 5px 10px;
            display: inline-block;
        }
        .level-bachelors {
            color: #27AE60; 
            font-weight: 700;
            background-color: #eaf7ee;
            border-radius: 4px;
            padding: 5px 10px;
            display: inline-block;
        }
        .level-certificate {
            color: #9B59B6; 
            font-weight: 700;
            background-color: #f7ebfb;
            border-radius: 4px;
            padding: 5px 10px;
            display: inline-block;
        }

        /* 6. Responsive Design */
        @media screen and (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 15px auto;
            }
            .controls {
                flex-direction: column;
                margin-left: -15px; 
                margin-right: -15px; 
                padding-left: 15px;
                padding-right: 15px;
            }
            .controls input, .controls select {
                width: 100%;
                margin-bottom: 10px;
            }
            table, thead, tbody, th, td, tr {
                display: block;
            }
            thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }
            tr {
                border: 1px solid #ccc;
                margin-bottom: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }
            td {
                border: none;
                border-bottom: 1px solid #eee;
                position: relative;
                padding-left: 55%;
                text-align: right;
            }
            td:before {
                position: absolute;
                top: 50%;
                left: 10px;
                width: 45%;
                padding-right: 10px;
                white-space: nowrap;
                content: attr(data-label);
                font-weight: bold;
                color: #555;
                transform: translateY(-50%);
                text-align: left;
            }
            td:nth-child(1) {
                text-align: right;
                padding-left: 55%;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="logo-container">
            <img src="logo.png" alt="NORTHWESTERN TRAINING INSTITUTE Logo" class="logo">
        </div>
        
        <h1>NORTHWESTERN TRAINING INSTITUTE</h1>
        <h2>List of Graduating Students (Total: 201 Entries)</h2>

        <div class="controls">
            <input type="text" id="searchInput" placeholder="Search by Name or Course..." onkeyup="filterTable()">
            <select id="courseFilter" onchange="filterTable()">
                <option value="">All Courses</option>
            </select>
        </div>
        
        <table id="enrollmentTable">
            <thead>
                <tr>
                    <th onclick="sortColumn(0)" data-column="no">NO. <span class="sort-icon"></span></th>
                    <th onclick="sortColumn(1)" data-column="name">Name <span class="sort-icon"></span></th>
                    <th onclick="sortColumn(2)" data-column="course">Course/Level <span class="sort-icon"></span></th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

    <script>
        // Data Array - Same as before
        const enrollmentData = [
            { no: 1, name: 'KOCHARA PETER LOTIANG', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 2, name: 'BOAZ ASICHE MUTEKWA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 3, name: 'STELA NABWILE SIMIYU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 4, name: 'MARTIN OCHIENG NG’OLA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 5, name: 'PIUS KIPCHUMBA KIPTOO', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 6, name: 'JAMES LOREEN', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 7, name: 'FRANCIS MACHARIA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 8, name: 'PETER EKWAR', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 9, name: 'VIOLET KAVAI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 10, name: 'JOYCE KEBOI WANJIKU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 11, name: 'PHILIP EROT', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 12, name: 'SARAPHYNE NABWIRE OMULA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 13, name: 'MILKA MAGIRI MAINA', course: 'CT-BIBLE & THEOLOGY' },
            { no: 14, name: 'MARYANN WANJIRU NJENGA', course: 'CT-BIBLE & THEOLOGY' },
            { no: 15, name: 'JUDITH WAITHERA KIARIE', course: 'CT-BIBLE & THEOLOGY' },
            { no: 16, name: 'GRACE OMBIMA', course: 'CT-BIBLE & THEOLOGY' },
            { no: 17, name: 'STEPHEN OUMA OPIYO', course: 'CT-BIBLE & THEOLOGY' },
            { no: 18, name: 'PETER MWANGI WAINAINA', course: 'CT-BIBLE & THEOLOGY' },
            { no: 19, name: 'JANET MWIKARI KIVONIO', course: 'CT-BIBLE & THEOLOGY' },
            { no: 20, name: 'EDWARD BOY CHIDD', course: 'CT-BIBLE & THEOLOGY' },
            { no: 21, name: 'DAVID NJUGUNA KIARIE', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 22, name: 'AGNES WANGUI NYIHA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 23, name: 'ROSELINE WANGARI KAMAU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 24, name: 'GEORGE GICHU MIGWI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 25, name: 'KENNEDY ADUBWA LIHANDA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 26, name: 'ABEL ONYANGO SANDE', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 27, name: 'FAITH WACEKE KARANJA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 28, name: 'PHILEMON KIPRUTO KIPROP', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 29, name: 'FRDRICK ICHOYA CHRGE', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 30, name: 'BANARD KARIUKI MUNGAI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 31, name: 'JONATHAN .K. CHEBOR', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 32, name: 'NANCY NAKHUNGU KHAKAME', course: 'DIP-COUNSELING PSYCHOLOGY' },
            { no: 33, name: 'SAMWEL KARANJA NGIGI', course: 'MA-COUNSELING PSYCHOLOGY' },
            { no: 34, name: 'PAUL MBURU NG’ANG’A', course: 'MA-COUNSELING PSYCHOLOGY' },
            { no: 35, name: 'ROSE NYOTIAH WANYAMA', course: 'MA-COUNSELING PSYCHOLOGY' },
            { no: 36, name: 'MADINA TEMKO', course: 'MA-COUNSELING PSYCHOLOGY' },
            { no: 37, name: 'DIANA KHWAKA WANASWA', course: 'MA-COUNSELING PSYCHOLOGY' },
            { no: 38, name: 'NAOMI KHANJILA WANJALA', course: 'BA COUNSELING PSYCHOLOGY' },
            { no: 39, name: 'MADINA TEMKO', course: 'BA COUNSELING PSYCHOLOGY' },
            { no: 40, name: 'WICLIFFE NYANGULE CHITECHI', course: 'BA COUNSELING PSYCHOLOGY' },
            { no: 41, name: 'JUDITH NASIMIYU SIKOLIA', course: 'BA COUNSELING PSYCHOLOGY' },
            { no: 42, name: 'MARIA TUNAI HASSAN', course: 'CT-BIBLE & THEOLOGY' },
            { no: 43, name: 'ELIAS WAFULA MUNYASI', course: 'CT-BIBLE & THEOLOGY' },
            { no: 44, name: 'STEPHEN WEKESA', course: 'CT-BIBLE & THEOLOGY' },
            { no: 45, name: 'ELIUD MANASE SIMIYU', course: 'CT-BIBLE & THEOLOGY' },
            { no: 46, name: 'BETTLYNE NEKESA OKUMU', course: 'CT-BIBLE & THEOLOGY' },
            { no: 47, name: 'WYCLIFFE IVUSA', course: 'CT-BIBLE & THEOLOGY' },
            { no: 48, name: 'GILBERT CHAVASINYA MAGOMERE', course: 'CT-BIBLE & THEOLOGY' },
            { no: 49, name: 'MODESTER AGAN', course: 'CT-BIBLE & THEOLOGY' },
            { no: 50, name: 'GEORGE AGESA ODEMBE', course: 'CT-BIBLE & THEOLOGY' },
            { no: 51, name: 'SOFIA  NAFULA MUSIKANA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 52, name: 'ALVIN WANJALA MURUTU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 53, name: 'MATAYO WANJALA ETORI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 54, name: 'COLETA NASIMIYU WANYONYI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 55, name: 'VIOLET NAFULA WAFULA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 56, name: 'PAULINE OSITA ASITWA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 57, name: 'JAMIN WANJALA SIKALA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 58, name: 'COLLINS WAFULA WEPUKHULU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 59, name: 'JOHN NALIANYA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 60, name: 'ALICE NANJEKHO WANYONYI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 61, name: 'BRIDGED NEKESA SIMIYU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 62, name: 'JARED OMONDI OKEYO', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 63, name: 'LARRY CANAAN WATAKO', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 64, name: 'TITUS OMONDI OMUDEKE', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 65, name: 'ASUMAN MPAMO', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 66, name: 'CONE ACHIENG OMONDI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 67, name: 'EVALINE NALWENGE OWOLA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 68, name: 'NORAH NAMACHANJA MUYALA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 69, name: 'DANIEL OJIAMBO EGESA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 70, name: 'JOSPHINE NANJALA SIMEMA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 71, name: 'ERIC SIMIYU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 72, name: 'PETER WANGILA MULUNDA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 73, name: 'MARY LYAMBILA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 74, name: 'JOSEPHINE NANJALA SIMEMA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 75, name: 'HELLEN WANJALA MUSOMI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 76, name: 'DOROTHY AUMA AMAASA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 77, name: 'NANCY NAKHUNGU KHAKAME', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 78, name: 'BRIAN WEKESA SIMIYU', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 79, name: 'SARAH NANJALA WEKESA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 80, name: 'HUDSON MADEGWA KHAYEBA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 81, name: 'ALEX GITAU NJERI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 82, name: 'NASHON MAJOR OMULI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 83, name: 'PATRICK OSINYA OUMA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 84, name: 'DANIEL IMOLI MAGOTSWI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 85, name: 'CHRISTINE NAFUNA KASILI', course: 'BA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 86, name: 'DENNIS WAMBUCHI', course: 'BA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 87, name: 'DENNIS WEKESA SIMIYU', course: 'BA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 88, name: 'JOSEPH SIMIYU WANYAMA.', course: 'BA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 89, name: 'GILBERT MAMAI', course: 'DIP PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 90, name: 'ADELAIDE NANJALA WEKESA', course: 'LEADERSHIP & PUBLIC GOVERNANCE' },
            { no: 91, name: 'REHEMA NASIMIYU FESA', course: 'MA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 92, name: 'YVONE NANJALA WASWA', course: 'BA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 93, name: 'JACKTON MULONGO CHETAMBE', course: 'MA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 94, name: 'ZAKARIA WANYONYICHEKECHI', course: 'MA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 95, name: 'PHILICE LUSIKE BARASA', course: 'MA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 96, name: 'GODFREY SIMIYU WANJALA', course: 'MA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 97, name: 'FESTUS MALELE ANJILI', course: 'MA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 98, name: 'SABWAMI CAROLYNE NAFULA', course: 'MA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 99, name: 'CAROLYN NAMWENYA MUCHOE', course: 'BA SOCIAL WORK & CRIMINOLOGY' },
            { no: 100, name: 'MOURINE KHANJILA WAFULA', course: 'MA PUBLIC ADMINISTRATION & POLITICAL SCIENCE' },
            { no: 101, name: 'MERCY NEKESA WEPUKHULU', course: 'BA PUBLIC ADMINISTRATION & GOVERNANCE' },
            { no: 102, name: 'VALENTINE NALIAKA WOPICHO', course: 'DIPLOMA CONFLICT RESOLUTION & MANAGEMENT' },
            { no: 103, name: 'KIRUAYE VIOLET MBAYAKI', course: 'MA IN EDUCATION PLANNING ADMINISTRATION & MANAGEMENT' },
            { no: 104, name: 'JANE NAFULA', course: 'MA IN EDUCATION PLANNING ADMINISTRATION & MANAGEMENT' },
            { no: 105, name: 'GLADYS NAFULA WEKUNDA', course: 'MA IN EDUCATION PLANNING ADMINISTRATION & MANAGEMENT' },
            { no: 106, name: 'SKYTRE MUKHWANA NDALILA', course: 'MA IN EDUCATION PLANNING ADMINISTRATION & MANAGEMENT' },
            { no: 107, name: 'LEWISLENNOX MULONGO NDALILA', course: 'MA IN EDUCATION PLANNING ADMINISTRATION & MANAGEMENT' },
            { no: 108, name: 'EVERLYNE NEKESA SIKOLIA', course: 'MA IN EDUCATION PLANNING ADMINISTRATION & MANAGEMENT' },
            { no: 109, name: 'DAMARIS APAMA EKIRAPA', course: 'BA CRIMINAL JUSTICE' },
            { no: 110, name: 'ALEX NANJALA NAKOKONYA', course: 'DIP-PROJECT PLANNING' },
            { no: 111, name: 'FEDELES  SITUMA JUMA', course: 'DEGREE- PROJECT PLANNING' },
            { no: 112, name: 'DOUGLAS WANGILA RUCHU', course: 'BA DEGREE-LAM' },
            { no: 113, name: 'JOSEPHINE SHIABANGA KIAGE', course: 'BA DEGREE-LAM' },
            { no: 114, name: 'SUSY NADI WATILA', course: 'BA DEGREE-LAM' },
            { no: 115, name: 'HILDABEDA KHAYELE LUKULU', course: 'BA DEGREE-LAM' },
            { no: 116, name: 'WILSON IBWAGA AVUNG’ANA', course: 'BA DEGREE-LAM' },
            { no: 117, name: 'TERESIA WANJIRU NJIHIA', course: 'BA DEGREE-LAM' },
            { no: 118, name: 'JOSEPH MASINDE', course: 'BA DEGREE-LAM' },
            { no: 119, name: 'EVANS ASACHA ASIRI', course: 'MA DEGREE -LAM' },
            { no: 120, name: 'ZIPIA NABAKENI WEKATI', course: 'BA DEGREE-EDUCATION ARTS' },
            { no: 121, name: 'CHARLES MANDEY BARASA', course: 'BA SPECIAL NEEDS' },
            { no: 122, name: 'WANJALA MOSES', course: 'BA ARTS IN KISWAHILI / CRE' },
            { no: 123, name: 'DORINE NASAMBU LUSAKA', course: 'BA BUSINESS ADMINISTRATION AND MANAGEMENT' },
            { no: 124, name: 'KUKALI GEORGE SIMIYU', course: 'BA BUSINESS ADMINISTRATION AND MANAGEMENT' },
            { no: 125, name: 'ANN YEKO CHESETO', course: 'BA EARLY CHILDHOOD EDUCATION (ECDE) & PRIMARY' },
            { no: 126, name: 'HARRY M. SAENYI', course: 'BA EDUCATION ARTS HISTORY & KISWAHILI' },
            { no: 127, name: 'COLLINS B. ODHIAMBO', course: 'BA EDUCATION ARTS HISTORY & KISWAHILI' },
            { no: 128, name: 'FRED MAKASI CHESEBE', course: 'BA EDUCATION ARTS ENGLISH & KISWAHILI' },
            { no: 129, name: 'ALEX KAPCHAN', course: 'BA EARLY CHILDHOOD EDUCATION (ECDE) & PRIMARY' },
            { no: 130, name: 'CONSTANCE KISAKA', course: 'BA EDUCATION ARTSHISTORY & KISWAHILI' },
            { no: 131, name: 'WANJALA DORINE', course: 'BA EDUCATION ARTSHISTORY & KISWAHILI' },
            { no: 132, name: 'JANEROSE TOTO SHAPILI', course: 'BA EARLY CHILDHOOD EDUCATION (ECDE) & PRIMARY' },
            { no: 133, name: 'AYUMA SAMOKA JER', course: 'BA EARLY CHILDHOOD EDUCATION (ECDE) & PRIMARY' },
            { no: 134, name: 'BEBREN SELUYA SAM', course: 'BA EDUCATION ARTS KISWAHILI&GEOGRAPHY' },
            { no: 135, name: 'MELISA ADONGO AKOTH', course: 'BA EARLY CHILDHOOD EDUCATION (ECDE) & PRIM' },
            { no: 136, name: 'CATHERINE NANJALA SIBALILE', course: 'BA EARLY CHILDHOOD EDUCATION (ECDE) & PRIMARY' },
            { no: 137, name: 'TIMOTHY MERU SITUMA', course: 'MA IN LANGUAGE & LINGUISTIC' },
            { no: 138, name: 'BENARD WALIAULA SOITA', course: 'BA DEGREE-BIBLE & THEOLOGY' },
            { no: 139, name: 'JOSEPH SITUMA MUSE', course: 'BA DEGREE-BIBLE & THEOLOGY' },
            { no: 140, name: 'IGNATIUS MASIKA WASKEH', course: 'BA DEGREE-BIBLE & THEOLOGY' },
            { no: 141, name: 'NG’OMBE WEKULO FRANK', course: 'BA DEGREE-BIBLE & THEOLOGY' },
            { no: 142, name: 'JOSIPHATI MATISIO BUSOLO', course: 'BA DEGREE-BIBLE & THEOLOGY' },
            { no: 143, name: 'JIM EPAINITUS LUGALIA LIDWAJI', course: 'BA DEGREE-BIBLE & THEOLOGY' },
            { no: 144, name: 'THOMAS KIPKEMBOI CHEBET', course: 'BA DEGREE-BIBLE & THEOLOGY, DIPLOMA (2024)' },
            { no: 145, name: 'JOAB LUSIMBO BARASA', course: 'BA DEGREE-BIBLE & THEOLOGY' },
            { no: 146, name: 'AGREY SAVAI INDEJE', course: 'PHD-BIBLE & THEOLOGY' },
            { no: 147, name: 'WILSON IMBWAGA ABUNG’ANA', course: 'BA DEGREE-LAM' },
            { no: 148, name: 'NICHOLUS KHAMISI MAGAJA', course: 'PHD-BIBLE & THEOLOGY' },
            { no: 149, name: 'JOSEPH KARIUKI', course: 'PHD-BIBLE & THEOLOGY' },
            { no: 150, name: 'MARGARET NJAMBI', course: 'PHD-BIBLE & THEOLOGY' },
            { no: 151, name: 'NAOMY NDEGWA', course: 'PHD-BIBLE & THEOLOGY' },
            { no: 152, name: 'VINCENT OLULU OMANYALA', course: 'MA-PROJECT PLANNING & MANAGEMRNT' },
            { no: 153, name: 'ALFRED LITETE ONYANGO', course: 'PHD-BIBLE & THEOLOGY' },
            { no: 154, name: 'SAMBWAMI KENNEDY NDALILA', course: 'PHD IN LAM' },
            { no: 155, name: 'MAWA BAPALE DIGUDONE', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 156, name: 'MAIGEMBE SUAN', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 157, name: 'KAUDHA SYLVIA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 158, name: 'MICAHEL SAGALA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 159, name: 'JOSEPH ELILU', course: 'DEGREE-BIBLE & THEOLOGY' },
            { no: 160, name: 'BETTY SANYA', course: 'DEGREE-BIBLE & THEOLOGY' },
            { no: 161, name: 'SIMON BATWALA', course: 'DEGREE-BIBLE & THEOLOGY' },
            { no: 162, name: 'NKERAMIHIGO GABRIEL', course: 'DEGREE-BIBLE & THEOLOGY' },
            { no: 163, name: 'OFWONO RAPAHEL', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 164, name: 'KIKOMEKO GIDEON', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 165, name: 'MUKISA SAMUEL', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 166, name: 'ROMAN OKWARE', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 167, name: 'NAMALWA MILKA JOSEPHINE', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 168, name: 'NABUKONDE GORETTI', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 169, name: 'LAWRENCE WALUCHO MAKOKHA', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 170, name: 'LUCY NGIMA MARIGI', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 171, name: 'WILSON AKORA RUBESA', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 172, name: 'PATRICK MBUGUA KINYANJUI', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 173, name: 'ELIZABETH WANGARE KAGUNDA', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 174, name: 'EMMAH OBWANA', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 175, name: 'INVIOLATOR NASWA WALUSUNA', course: 'MASTERS-BIBLE & THEOLOGY' },
            { no: 176, name: 'BENJAMIN WAMALWA KHAEMBA', course: 'BA-BIBLE & THEOLOGY' },
            { no: 177, name: 'LYNN NGINA NGANGA', course: 'BA-BIBLE & THEOLOGY' },
            { no: 178, name: 'FRED WEKESA WADABWA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 179, name: 'IRENE CHEBUKWA KHAOYA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 180, name: 'MUKHONGO.N.JANET', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 181, name: 'GEOFFREY JUMA WANYAMA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 182, name: 'ALPHA ANZEZE ASWANI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 183, name: 'VALENTINE SIMIYU MABONGA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 184, name: 'ROSE NASAMBU MUNUYA', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 185, name: 'GEORGE GORDEN MUTSEMBI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 186, name: 'CHRISTOPHER AMAKOBE OMOLO', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 187, name: 'MARY MUYOKA MASINDE', course: 'BA-BIBLE & THEOLOGY' },
            { no: 188, name: 'GEOFREY SIUNDU WAFULA', course: 'BA-BIBLE & THEOLOGY' },
            { no: 189, name: 'MARY WANJIRU NJUGUNA', course: 'BA HUMAN RESIOURCS & SOCIAL DEVELOPMENT' },
            { no: 190, name: 'ANN MUTHONI MURIUKI', course: 'BA HUMAN RESIOURCS & SOCIAL DEVELOPMENT' },
            { no: 191, name: 'PETER WAFULA MUYONDO', course: 'BA-BIBLE & THEOLOGY' },
            { no: 192, name: 'MONICAH MWASHI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 193, name: 'MARY NJERI MWANGI', course: 'DIP-BIBLE & THEOLOGY' },
            { no: 194, name: 'JOHN KUNGU NDIRANGU', course: 'BA-BIBLE & THEOLOGY, BA COUNSELLING PSYCHOLOGY' },
            { no: 195, name: 'TIMOTHY MERU SITUMA', course: 'MA LINGUISTIC' },
            { no: 196, name: 'TIMOTHY KIOKO MUTUNGA', course: 'BA LAM' },
            { no: 197, name: 'MIRIAM KANINI', course: 'MA –ARTS KISWAHILI' },
            { no: 198, name: 'JUDY ONGORO OMOLLO', course: 'MA –ARTS KISWAHILI' },
            { no: 199, name: 'WAFULA MACHUMA WINNIE', course: 'MA –ARTS RELIGION' },
            { no: 200, name: 'EVANS MUAMBU WATERA', course: 'PhD- KISWAHILI' },
            { no: 201, name: 'JANE DOE', course: 'DIP-BIBLE & THEOLOGY' } 
        ];

        const tableBody = document.querySelector('#enrollmentTable tbody');
        let currentSortColumn = null;
        let currentSortDirection = 'asc'; // 'asc' or 'desc'

        // Helper function to create HTML with highlighting
        function highlightText(text, search) {
            if (!search) return text;
            const re = new RegExp(`(${search})`, 'gi');
            return text.replace(re, '<span class="highlight">$1</span>');
        }

        // Helper function to get the CSS class based on course name
        function getLevelClass(courseName) {
            const course = courseName.toUpperCase();
            if (course.includes('PHD')) return 'level-phd';
            if (course.includes('MA') || course.includes('MASTERS')) return 'level-masters';
            if (course.includes('DIP') || course.includes('DIPLOMA')) return 'level-diploma';
            if (course.includes('BA') || course.includes('DEGREE')) return 'level-bachelors';
            if (course.includes('CT')) return 'level-certificate';
            return ''; 
        }

        // Function to render the table (with highlighting)
        function renderTable(data, searchInput = '') {
            tableBody.innerHTML = ''; 
            const searchLower = searchInput.toLowerCase();

            data.forEach(student => {
                const row = tableBody.insertRow();
                const levelClass = getLevelClass(student.course);
                
                // 1. NO. Cell
                let cellNo = row.insertCell();
                cellNo.innerHTML = highlightText(String(student.no), searchLower);
                cellNo.setAttribute('data-label', 'NO.');

                // 2. Name Cell
                let cellName = row.insertCell();
                cellName.innerHTML = highlightText(student.name, searchLower);
                cellName.setAttribute('data-label', 'Name');

                // 3. Course/Level Cell
                let cellCourse = row.insertCell();
                const courseText = highlightText(student.course, searchLower);
                cellCourse.innerHTML = `<span class="${levelClass}">${courseText}</span>`;
                cellCourse.setAttribute('data-label', 'Course/Level');
            });
        }

        // Function to handle Search and Filter logic
        function filterTable() {
            const searchInput = document.getElementById('searchInput').value.trim();
            const courseFilterValue = document.getElementById('courseFilter').value;

            let filteredData = enrollmentData.filter(student => {
                // 1. Check Course Filter
                const courseMatch = courseFilterValue === "" || student.course === courseFilterValue;

                // 2. Check Search Input
                const searchMatch = searchInput === "" || 
                    student.name.toLowerCase().includes(searchInput.toLowerCase()) ||
                    student.course.toLowerCase().includes(searchInput.toLowerCase());

                return courseMatch && searchMatch;
            });
            
            // Re-apply sorting to the newly filtered data
            if (currentSortColumn !== null) {
                const columnIndex = currentSortColumn;
                const columnName = document.querySelectorAll('#enrollmentTable thead th')[columnIndex].getAttribute('data-column');
                
                filteredData.sort((a, b) => {
                    const aValue = a[columnName];
                    const bValue = b[columnName];
                    let comparison = 0;

                    if (typeof aValue === 'number') {
                        comparison = aValue - bValue;
                    } else {
                        comparison = aValue.localeCompare(bValue);
                    }

                    return currentSortDirection === 'asc' ? comparison : comparison * -1;
                });
            }

            renderTable(filteredData, searchInput);
        }

        // Function to populate the Course Filter dropdown
        function populateCourseFilter() {
            const courses = [...new Set(enrollmentData.map(item => item.course))];
            const filterDropdown = document.getElementById('courseFilter');

            courses.sort().forEach(course => {
                const option = document.createElement('option');
                option.value = course;
                option.textContent = course;
                filterDropdown.appendChild(option);
            });
        }
        
        // Function to handle column sorting
        function sortColumn(columnIndex) {
            const headers = document.querySelectorAll('#enrollmentTable thead th');
            const columnName = headers[columnIndex].getAttribute('data-column');

            // Determine sort direction
            if (currentSortColumn === columnIndex) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                // Reset direction if a new column is clicked
                currentSortDirection = 'asc';
                currentSortColumn = columnIndex;
            }

            // Remove previous sort classes and icons
            headers.forEach(th => {
                th.classList.remove('asc', 'desc');
            });

            // Add current sort class and icon
            headers[columnIndex].classList.add(currentSortDirection);

            // Re-filter and re-render the table with the new sort order
            filterTable();
        }


        // Initialize the table and filter when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Initial render without sorting or filtering
            renderTable(enrollmentData);
            populateCourseFilter();
            
            // Set initial sort state (e.g., sort by NO. ascending)
            sortColumn(0); 
        });
    </script>

</body>
</html>